import hashlib

def crack_sha1_hash(hash, use_salts=False):
  found = False
  salts = []
  passwords = []
  with open('known-salts.txt') as salts_file:
    salts = salts_file.readlines()
  with open('top-10000-passwords.txt') as passwords_file:
    passwords = passwords_file.readlines()
  for password in passwords:
    password = password.strip()
    if use_salts:
      for salt in salts:
        salt = salt.strip()
        new_password_a = f'{password}{salt}'.encode('utf-8')
        new_password_p = f'{salt}{password}'.encode('utf-8')
        if hashlib.sha1(new_password_a).hexdigest() == hash or hashlib.sha1(new_password_p).hexdigest() == hash:
          found = password
          break
    else:
      new_password = password.encode('utf-8')
      if hashlib.sha1(new_password).hexdigest() == hash:
        found = password
        break
  return 'PASSWORD NOT IN DATABASE' if not found else found